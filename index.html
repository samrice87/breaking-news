<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Breaking News Monitor</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 0; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // Lucide Icons as inline SVG components
        const Bell = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
            </svg>
        );
        
        const Twitter = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"/>
            </svg>
        );
        
        const Clock = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12 6 12 12 16 14"/>
            </svg>
        );
        
        const ExternalLink = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                <polyline points="15 3 21 3 21 9"/>
                <line x1="10" y1="14" x2="21" y2="3"/>
            </svg>
        );
        
        const RefreshCw = ({ className }) => (
            <svg className={className} width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="23 4 23 10 17 10"/>
                <polyline points="1 20 1 14 7 14"/>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
            </svg>
        );

        const BreakingNewsMonitor = () => {
          const [articles, setArticles] = useState([]);
          const [seenIds, setSeenIds] = useState(new Set());
          const [lastUpdate, setLastUpdate] = useState(null);
          const [isLoading, setIsLoading] = useState(false);
          const [newCount, setNewCount] = useState(0);
          const audioRef = useRef(null);

          const feeds = [
            { url: 'https://nitter.net/AP/rss', name: 'AP News', priority: 'high' },
            { url: 'https://nitter.net/Reuters/rss', name: 'Reuters', priority: 'high' },
            { url: 'https://nitter.net/CNN/rss', name: 'CNN', priority: 'medium' },
            { url: 'https://nitter.net/CNNPolitics/rss', name: 'CNN Politics', priority: 'high' },
            { url: 'https://nitter.net/FoxNews/rss', name: 'Fox News', priority: 'medium' },
            { url: 'https://nitter.net/NBCNews/rss', name: 'NBC News', priority: 'medium' },
            { url: 'https://nitter.net/Breaking911/rss', name: 'Breaking911', priority: 'high' },
            { url: 'https://nitter.net/BNONews/rss', name: 'BNO News', priority: 'high' },
          ];

          const fetchFeeds = async () => {
            setIsLoading(true);
            const newArticles = [];
            let hasNewItems = false;

            for (const feed of feeds) {
              try {
                const response = await fetch(feed.url);
                const text = await response.text();
                const parser = new DOMParser();
                const xml = parser.parseFromString(text, 'text/xml');
                const items = xml.querySelectorAll('item');

                items.forEach((item, index) => {
                  if (index < 5) {
                    const title = item.querySelector('title')?.textContent || '';
                    const link = item.querySelector('link')?.textContent || '';
                    const pubDate = item.querySelector('pubDate')?.textContent || '';
                    const id = `${feed.name}-${title}`;

                    const isBreaking = title.toLowerCase().includes('breaking') || 
                                     title.toLowerCase().includes('urgent') ||
                                     title.includes('ðŸš¨');

                    if (!seenIds.has(id)) {
                      hasNewItems = true;
                      newArticles.push({
                        id,
                        title,
                        link,
                        source: feed.name,
                        time: new Date(pubDate),
                        isNew: true,
                        isBreaking,
                        priority: feed.priority
                      });
                    } else {
                      newArticles.push({
                        id,
                        title,
                        link,
                        source: feed.name,
                        time: new Date(pubDate),
                        isNew: false,
                        isBreaking,
                        priority: feed.priority
                      });
                    }
                  }
                });
              } catch (error) {
                console.error(`Error fetching ${feed.name}:`, error);
              }
            }

            newArticles.sort((a, b) => b.time - a.time);

            const newSeenIds = new Set(seenIds);
            newArticles.forEach(article => newSeenIds.add(article.id));
            setSeenIds(newSeenIds);

            setArticles(newArticles);
            setLastUpdate(new Date());
            setIsLoading(false);

            if (hasNewItems && seenIds.size > 0) {
              const newItemsCount = newArticles.filter(a => a.isNew).length;
              setNewCount(newItemsCount);
              if (audioRef.current) {
                audioRef.current.play().catch(e => console.log('Audio play failed:', e));
              }
              
              setTimeout(() => setNewCount(0), 3000);
            }
          };

          useEffect(() => {
            fetchFeeds();
            const interval = setInterval(fetchFeeds, 60000);
            return () => clearInterval(interval);
          }, []);

          const formatTime = (date) => {
            const now = new Date();
            const diff = Math.floor((now - date) / 1000);
            
            if (diff < 60) return 'Just now';
            if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;
            if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;
            return date.toLocaleTimeString();
          };

          const getPriorityColor = (priority) => {
            if (priority === 'high') return 'border-l-red-500';
            if (priority === 'medium') return 'border-l-orange-500';
            return 'border-l-blue-500';
          };

          return (
            <div className="min-h-screen bg-gray-900 text-white p-4">
              <audio ref={audioRef} src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUKXh8LdnHwU2jdXzzn0vBSF1xe/glEILElyx6OyrWBUIQ5zd8sFuJAUrhM/y2Ik2CBxqvfDknE4MDlCl4fC3Zx8FNo3V8859LwUhdcXv4JRCC w==" />

              <div className="max-w-4xl mx-auto mb-6">
                <div className="flex items-center justify-between mb-4">
                  <div className="flex items-center gap-3">
                    <Twitter />
                    <h1 className="text-2xl font-bold">Breaking News Monitor</h1>
                  </div>
                  <button
                    onClick={fetchFeeds}
                    disabled={isLoading}
                    className="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg disabled:opacity-50"
                  >
                    <RefreshCw className={isLoading ? 'animate-spin' : ''} />
                    Refresh
                  </button>
                </div>

                <div className="flex items-center justify-between text-sm bg-gray-800 p-3 rounded-lg">
                  <div className="flex items-center gap-2">
                    <Clock />
                    <span className="text-gray-400">
                      Last update: {lastUpdate ? formatTime(lastUpdate) : 'Loading...'}
                    </span>
                  </div>
                  {newCount > 0 && (
                    <div className="flex items-center gap-2 bg-red-600 px-3 py-1 rounded-full animate-pulse">
                      <Bell />
                      <span className="font-bold">{newCount} New</span>
                    </div>
                  )}
                </div>
              </div>

              <div className="max-w-4xl mx-auto space-y-3">
                {articles.length === 0 ? (
                  <div className="text-center py-12 text-gray-400">
                    <RefreshCw className="w-12 h-12 mx-auto mb-4 animate-spin" />
                    <p>Loading breaking news...</p>
                  </div>
                ) : (
                  articles.map((article) => (
                    <div
                      key={article.id}
                      className={`bg-gray-800 border-l-4 ${getPriorityColor(article.priority)} p-4 rounded-lg transition-all ${
                        article.isNew ? 'ring-2 ring-blue-500 animate-pulse' : ''
                      }`}
                    >
                      <div className="flex items-start justify-between gap-3">
                        <div className="flex-1">
                          <div className="flex items-center gap-2 mb-2">
                            <span className="text-xs font-bold text-blue-400">{article.source}</span>
                            <span className="text-xs text-gray-500">â€¢</span>
                            <span className="text-xs text-gray-400">{formatTime(article.time)}</span>
                            {article.isNew && (
                              <span className="text-xs bg-red-600 px-2 py-0.5 rounded-full font-bold">
                                NEW
                              </span>
                            )}
                            {article.isBreaking && (
                              <span className="text-xs bg-yellow-600 px-2 py-0.5 rounded-full font-bold">
                                ðŸš¨ BREAKING
                              </span>
                            )}
                          </div>
                          <h3 className="text-base font-medium leading-tight mb-2">
                            {article.title}
                          </h3>
                        </div>
                        
                          href={article.link}
                          target="_blank"
                          rel="noopener noreferrer"
                          className="flex-shrink-0 text-blue-400 hover:text-blue-300"
                        >
                          <ExternalLink />
                        </a>
                      </div>
                    </div>
                  ))
                )}
              </div>

              <div className="max-w-4xl mx-auto mt-8 p-4 bg-gray-800 rounded-lg text-sm text-gray-400">
                <p className="font-bold text-white mb-2">ðŸ“± Add to Home Screen:</p>
                <p className="mb-2">iPhone: Tap Share â†’ Add to Home Screen</p>
                <p>Android: Tap Menu (â‹®) â†’ Add to Home screen</p>
                <p className="mt-3 text-xs">Checks every 60 seconds. Keep browser tab open for alerts.</p>
              </div>
            </div>
          );
        };

        ReactDOM.render(<BreakingNewsMonitor />, document.getElementById('root'));
    </script>
</body>
</html>
